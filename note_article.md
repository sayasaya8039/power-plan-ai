# 【無料公開】AIがあなたのPC使用パターンを学習して電源プランを自動最適化するアプリを作った

こんにちは！今回は、**Windows電源プランをAIで自動最適化するアプリ「Power Plan AI」**を開発したので紹介します。

---

## なぜ作ったか

皆さん、Windows PCを使っていてこんな経験ありませんか？

- ゲームするときは「高パフォーマンス」に切り替えたい
- バッテリー残量が少ないときは「省電力」にしたい
- 普段の作業では「バランス」でいい

でも毎回手動で切り替えるのって面倒ですよね？

そこで「**AIがユーザーの使用パターンを学習して、最適な電源プランを自動で選んでくれたら便利じゃない？**」と思い、作ってしまいました。

---

## Power Plan AI とは

![アプリイメージ](アプリのスクリーンショット)

**Power Plan AI** は、あなたのPC使用パターンを学習し、最適な電源プランを自動で切り替えるWindowsアプリです。

### 主な特徴

**1. AI自動最適化**
- 使用中のアプリ、時間帯、CPU負荷、バッテリー状態を監視
- 1週間程度の使用でユーザーの生活パターンを学習
- 学習が進むと予測精度が向上（最大85%）

**2. 4つの電源プラン対応**
- 究極のパフォーマンス（ゲーム・重い作業向け）
- 高パフォーマンス
- バランス
- 省電力

**3. システムトレイ常駐**
- トレイアイコンで現在のプランを一目で確認
- ダブルクリックでダッシュボード表示
- 右クリックメニューで手動切替も可能

**4. プライバシー保護**
- 全てローカル処理、外部送信なし
- データは `%APPDATA%/PowerPlanAI/` に保存

---

## 使い方

### インストール

1. [GitHub Releases](https://github.com/sayasaya8039/power-plan-ai/releases) から `PowerPlanAI.exe` をダウンロード
2. ダブルクリックで起動
3. システムトレイにアイコンが表示されます

### 基本操作

- **トレイアイコンダブルクリック**: ダッシュボード表示
- **トレイアイコン右クリック**: メニューから電源プラン切替
- **AI自動最適化**: デフォルトで有効（メニューからON/OFF可能）

---

## ダッシュボード画面

```
┌─────────────────────────────────────────┐
│  ⚡ Power Plan AI                        │
│  AIが最適な電源プランを自動選択します   │
├─────────────────────────────────────────┤
│  現在のプラン │ バッテリー │ CPU使用率  │
│    バランス   │    96%     │    22%     │
├─────────────────────────────────────────┤
│  👑 究極  🚀 高パフォ  ⚖️ バランス  🔋 省電力  │
├─────────────────────────────────────────┤
│  AI推奨: バランス                       │
│  理由: 標準設定（学習データ収集中）     │
│  信頼度: ████████░░ 80%                 │
└─────────────────────────────────────────┘
```

---

## 技術スタック

| カテゴリ | 使用技術 |
|---------|----------|
| 言語 | Python 3.11+ |
| GUI | PyQt6 |
| システム監視 | psutil, pywin32 |
| データベース | SQLite |
| 機械学習 | scikit-learn (パターン学習) |
| ビルド | PyInstaller |

---

## AIの仕組み

Power Plan AIのAIは、以下の情報を監視・学習します：

1. **時間帯**: 朝は省電力、夜はゲーム用に高パフォーマンス…など
2. **曜日**: 平日はバランス、週末は高パフォーマンス…など
3. **使用アプリ**: ゲームやDTWソフトなら高パフォーマンス…など
4. **CPU負荷**: 負荷が高いときは自動で高パフォーマンス
5. **バッテリー**: 20%未満なら強制省電力モード

これらのデータを組み合わせて、ユーザーの行動パターンを学習。信頼度が70%を超えると自動で電源プランを切り替えます。

---

## 開発の裏話

### なぜPythonで作ったか

当初はTauri（Rust + TypeScript）で作ろうと思っていましたが：
- Windows専用なのでクロスプラットフォーム対応不要
- AI/MLライブラリはPythonが圧倒的に充実
- 開発速度優先

という理由でPython + PyQt6を選択しました。

### 苦労した点

1. **PyInstallerのモジュール問題**: psutilやsqlite3がうまくバンドルされず、`--collect-all` や `--hidden-import` で解決
2. **究極のパフォーマンスプラン**: Windows 10 Pro/Enterpriseにしか標準では表示されないため、`powercfg -duplicatescheme` で自動作成する仕組みを実装

---

## GitHub

ソースコードはGitHubで公開しています：

**https://github.com/sayasaya8039/power-plan-ai**

IssueやPRお待ちしております！

---

## 今後の予定

- スタートアップ登録機能
- 詳細な統計グラフ
- カスタムルール設定

---

## まとめ

Power Plan AIを使えば、もう電源プランの手動切替から解放されます。AIがあなたの使用パターンを学習して、最適なプランを自動で選んでくれます。

ぜひ試してみてください！

---

ダウンロードはこちら：
**https://github.com/sayasaya8039/power-plan-ai/releases**

---

いいねとフォローお願いします！質問やフィードバックはコメントへ！
